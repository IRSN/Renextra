---
title: "R package Renextra"
linkcolor: blue
output: github_document
---


## Goals

The **Renextra** R package has been financed by IRSN Behrig. It aims
at enhancing the **Renext** package which is available [on
CRAN](https://cran.r-project.org/web/packages/Renext/index.html) and
on the [IRSN GitHub](https://github.com/IRSN/Renext) public repos.

The present features of **Renextra** are

- Enhanced graphics relying on the **ggplot2** package. The `autoplot`
  method and (to a lesser extend) `autolayer` method can be used to
  get standard plots as used in Peaks Over Threshold analyses, such as
  the return-level plot.

- S3 class `RenouvTList` for threshold choice and so-called *threshold
  stability plot*.
  
- Experimental implementation of the Extended Generalized Pareto
 Distribution EGPD3 of Papatatopoulos and Tawn (2013).
 
 Note that the use of the EGPD3 relies on the the general features of
 the **Renext** pacakge, in which the distribution of the excesses
 over the threshold can be quite arbitrary. So, some initial values of
 the parameters must be given. The estimated values of the `scale` and
 `shape` parameters obtained by using the `"GPD"` distribution can be
 used alogn with `kappa = 1.0`, see the examples.
 
 

## Installing

Provided that the **remotes** package is installed, the installation of
dailymet from github can be done by using


```{r, eval=FALSE}
library(remotes)
install_github("yvesdeville/Renextra", dependencies = TRUE, auth_token = myToken)
```
where `myToken` is *your* token. 

You can also select a specific branch or a specific commit by using
the suitable syntax for `install_github`, see the **remotes** package
documentation.

## Examples

### Garonne (Jitterized)
```{r, message=FALSE, fig.height=4}
library(Renextra)
autoplot(GaronneJit)
```

```{r, message=FALSE, fig.height=4}
fitGJ <- Renouv(GaronneJit, distname.y = "GPD", plot = FALSE)
autoplot(fitGJ)
```

### Nidd River 

```{r, message=FALSE, fig.height=4}
 library(mev)
 fit <- RenouvTList(nidd,
                    effDuration = 35,
                    threshold = seq(from =70, to = 140, by = 10),
                    distname.y = "GPD")
 summary(fit)
 autoplot(fit, show = list(quant = TRUE, allObs= TRUE))
 ## Threshold Stability with ECGPD3
 fitE <- RenouvTList(nidd,
                     effDuration = 35,
                     threshold = seq(from = 65.08, to = 88.61, len = 40),
                     start.par.y = c(scale = 30, shape = 0.0, kappa = 1.0),
                     distname.y = "EGPD3")
 autoplot(coSd(fitE, lambda = FALSE))

```
 
## References 
 
Davison A.C. and Smith R.L. (1990) "Models for Exceedances over High Thresholds"
  *J.R. Statist. Soc. B* (**52**) pp. 393-442.
 
Papastathopoulos I. and Tawn J.A. (2013) "Extended Generalized Pareto
    Models for Tail Estimation", *Journal of Statistical
    Planning and Inference* (**143**), pp. 131-143.
